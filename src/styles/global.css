/* Global stylesheet (Phase 1) */
@import './tokens.css';

:root {
  color-scheme: light;
}

* { box-sizing: border-box; }
html { -webkit-text-size-adjust: 100%; }
body {
  font-family: var(--font-sans);
  font-size: var(--font-size-base);
  line-height: var(--line-height-normal);
  margin: 0;
  background: var(--color-bg);
  color: var(--color-fg);
  text-rendering: optimizeLegibility;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

img, svg, video { max-width: 100%; height: auto; }
img { display: block; }

h1,h2,h3,h4,h5,h6 { font-family: var(--font-serif); line-height: var(--line-height-tight); margin: var(--space-7) 0 var(--space-3); font-weight: 600; }

h1 { font-size: var(--font-size-4xl); }
h2 { font-size: var(--font-size-3xl); }
h3 { font-size: var(--font-size-2xl); }
h4 { font-size: var(--font-size-xl); }
h5 { font-size: var(--font-size-lg); }
h6 { font-size: var(--font-size-md); }

p, ul, ol, dl, blockquote { margin: 0 0 var(--space-5); }

ul, ol { padding-left: 1.2rem; }

a { color: var(--color-primary); text-decoration: none; transition: color var(--transition-fast); }
a:hover, a:focus { text-decoration: underline; }

:focus-visible { outline: 2px solid var(--color-focus); outline-offset: 2px; }

button { font: inherit; }

/* Form elements (shared) */
input[type="text"], input[type="email"], textarea {
  background: var(--color-bg-alt);
  color: var(--color-fg);
  transition: background var(--transition-fast), border-color var(--transition-fast);
}
input[type="text"]:focus, input[type="email"]:focus, textarea:focus {
  outline: 2px solid var(--color-primary);
  outline-offset: 1px;
}

/* Dark theme comfortable form adjustments */
[data-theme='dark'] input[type="text"],
[data-theme='dark'] input[type="email"],
[data-theme='dark'] textarea {
  background: #1b2534; /* slightly lighter than bg-alt for separation */
  border: 1px solid #46566e; /* mid border for less glare */
  color: #f1f5f9;
  caret-color: var(--color-primary);
}
[data-theme='dark'] input[type="text"]:focus,
[data-theme='dark'] input[type="email"]:focus,
[data-theme='dark'] textarea:focus {
  background: #233044; /* subtle elevate */
  border-color: var(--color-primary);
}
[data-theme='dark'] ::placeholder {
  color: #94a3b8;
}
[data-theme='dark'] input[disabled],
[data-theme='dark'] textarea[disabled] {
  background: #16202e;
  opacity: .7;
}

code, pre { font-family: var(--font-mono); font-size: 0.95em; }
pre { padding: var(--space-4); background: var(--color-bg-alt); border-radius: var(--radius-md); overflow:auto; }

hr { border: none; border-top: 1px solid var(--color-border); margin: var(--space-8) 0; }

/* Layout primitives */
.container { max-width: var(--content-max); margin: 0 auto; padding: 0 var(--space-4); }
.section { padding: var(--space-7) 0; }

/* Utilities */
.text-center { text-align: center; }
.muted { color: var(--color-fg-mid); }
.visually-hidden { position: absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0; }

/* Navigation */
.nav { list-style: none; margin:0; padding:0; display:flex; gap: var(--space-4); }
.nav a { padding: var(--space-2) var(--space-3); border-radius: var(--radius-sm); }
.nav a.active { background: var(--color-primary-light); }

/* Mobile nav adjustments: keep items on single line, allow horizontal scroll instead of wrapping */
@media (max-width: 640px) {
  .site-header { padding: var(--space-3) var(--space-3) calc(var(--space-3) + 4px); }
  .nav { 
    gap: var(--space-2);
    font-size: 0.875rem; /* slightly smaller to fit */
    flex-wrap: nowrap; 
    overflow-x: auto; 
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none; /* Firefox */
  }
  .nav::-webkit-scrollbar { display: none; }
  .nav a { padding: 4px 10px; white-space: nowrap; }
  /* Provide right padding so last item not obscured by theme toggle absolute button */
  .site-header .container { gap: var(--space-4); }
  .site-header nav { max-width: 100%; flex: 1 1 auto; }
  .logo span { display: none; } /* hide text to reclaim space, keep avatar image */
  .logo a { gap: 0; }
}

/* Very narrow fallback (e.g., 320px) â€“ reduce padding further */
@media (max-width: 380px) {
  .nav a { padding: 4px 8px; }
}

/* Header/Footer */
.site-header { padding: var(--space-4); border-bottom: 1px solid var(--color-border); background: var(--color-bg); }
.site-footer { padding: var(--space-6) var(--space-4); font-size: var(--font-size-sm); background: var(--color-bg-alt); margin-top: var(--space-8); }

.skip-link { position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip-link:focus { left:8px; top:8px; width:auto; height:auto; background:var(--color-bg); padding:var(--space-2) var(--space-3); border:2px solid var(--color-primary); z-index:1000; }

.main { padding: var(--space-6) 0; flex: 1 0 auto; }

.site-footer { flex-shrink: 0; }

/* Theme toggle icon button */
.theme-icon-btn {
  background: var(--color-bg-alt);
  border: 1px solid var(--color-border);
  padding: 6px;
  border-radius: 50%;
  cursor: pointer;
  color: var(--color-fg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: background var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast), transform var(--transition-fast);
}
.theme-icon-btn:hover, .theme-icon-btn:focus-visible {
  background: var(--color-primary-light);
  border-color: var(--color-primary);
  outline: none;
}
.theme-icon-btn:active { transform: scale(.92); }

[data-theme='dark'] .theme-icon-btn {
  background: #1b2534;
  border-color: #46566e;
  color: #f1f5f9;
}
[data-theme='dark'] .theme-icon-btn:hover, [data-theme='dark'] .theme-icon-btn:focus-visible {
  background: #233044;
  border-color: var(--color-primary);
}

/* Smooth theme cross-fade (opt-in via JS adds .theme-animating briefly). */
@media (prefers-reduced-motion: no-preference) {
  .theme-animating, .theme-animating * {
    transition: background-color 250ms ease, color 250ms ease, border-color 250ms ease, fill 250ms ease, stroke 250ms ease;
  }
  /* Avoid animating large images/videos for performance */
  .theme-animating img, .theme-animating video { transition: none !important; }
}

/* Prevent transition flash on first paint */
html:not(.js) .theme-animating { transition: none !important; }
