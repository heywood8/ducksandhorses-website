/* Global stylesheet (Phase 1) */
@import './tokens.css';

:root {
  color-scheme: light;
}

* { box-sizing: border-box; }
html { -webkit-text-size-adjust: 100%; }
body {
  font-family: var(--font-sans);
  font-size: var(--font-size-base);
  line-height: var(--line-height-normal);
  margin: 0;
  background: var(--color-bg);
  color: var(--color-fg);
  text-rendering: optimizeLegibility;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Use dynamic viewport height on mobile browsers that support it to reduce phantom scroll space */
@supports (height: 100dvh) {
  body { min-height: 100dvh; }
}

img, svg, video { max-width: 100%; height: auto; }
img { display: block; }

h1,h2,h3,h4,h5,h6 { font-family: var(--font-serif); line-height: var(--line-height-tight); margin: var(--space-7) 0 var(--space-3); font-weight: 600; }

h1 { font-size: var(--font-size-4xl); }
h2 { font-size: var(--font-size-3xl); }
h3 { font-size: var(--font-size-2xl); }
h4 { font-size: var(--font-size-xl); }
h5 { font-size: var(--font-size-lg); }
h6 { font-size: var(--font-size-md); }

p, ul, ol, dl, blockquote { margin: 0 0 var(--space-5); }

ul, ol { padding-left: 1.2rem; }

a { color: var(--color-primary); text-decoration: none; transition: color var(--transition-fast); }
a:hover, a:focus { text-decoration: underline; }

:focus-visible { outline: 2px solid var(--color-focus); outline-offset: 2px; }

button { font: inherit; }

/* Form elements (shared) */
input[type="text"], input[type="email"], textarea {
  background: var(--color-bg-alt);
  color: var(--color-fg);
  transition: background var(--transition-fast), border-color var(--transition-fast);
}
input[type="text"]:focus, input[type="email"]:focus, textarea:focus {
  outline: 2px solid var(--color-primary);
  outline-offset: 1px;
}

/* Dark theme comfortable form adjustments */
[data-theme='dark'] input[type="text"],
[data-theme='dark'] input[type="email"],
[data-theme='dark'] textarea {
  background: #1b2534; /* slightly lighter than bg-alt for separation */
  border: 1px solid #46566e; /* mid border for less glare */
  color: #f1f5f9;
  caret-color: var(--color-primary);
}
[data-theme='dark'] input[type="text"]:focus,
[data-theme='dark'] input[type="email"]:focus,
[data-theme='dark'] textarea:focus {
  background: #233044; /* subtle elevate */
  border-color: var(--color-primary);
}
[data-theme='dark'] ::placeholder {
  color: #94a3b8;
}
[data-theme='dark'] input[disabled],
[data-theme='dark'] textarea[disabled] {
  background: #16202e;
  opacity: .7;
}

code, pre { font-family: var(--font-mono); font-size: 0.95em; }
pre { padding: var(--space-4); background: var(--color-bg-alt); border-radius: var(--radius-md); overflow:auto; }

hr { border: none; border-top: 1px solid var(--color-border); margin: var(--space-8) 0; }

/* Layout primitives */
.container { max-width: var(--content-max); margin: 0 auto; padding: 0 var(--space-4); }
.section { padding: var(--space-7) 0; }

/* Utilities */
.text-center { text-align: center; }
.muted { color: var(--color-fg-mid); }
.visually-hidden { position: absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0; }

/* Navigation */
.nav { list-style: none; margin:0; padding:0; display:flex; gap: var(--space-4); }
.nav a { padding: var(--space-2) var(--space-3); border-radius: var(--radius-sm); }
.nav a.active { background: var(--color-primary-light); }

/* Mobile nav adjustments: keep items on single line, allow horizontal scroll instead of wrapping */
@media (max-width: 640px) {
  .site-header { padding: var(--space-3) var(--space-3) calc(var(--space-3) + 4px); }
  .nav { 
    gap: var(--space-2);
    font-size: 0.875rem; /* slightly smaller to fit */
    flex-wrap: nowrap; 
    overflow-x: auto; 
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none; /* Firefox */
  }
  .nav::-webkit-scrollbar { display: none; }
  .nav a { padding: 4px 10px; white-space: nowrap; }
  /* Provide right padding so last item not obscured by theme toggle absolute button */
  .site-header .container { gap: var(--space-4); }
  .site-header nav { max-width: 100%; flex: 1 1 auto; }
  .logo span { display: none; } /* hide text to reclaim space, keep avatar image */
  .logo a { gap: 0; }
}

/* Very narrow fallback (e.g., 320px) â€“ reduce padding further */
@media (max-width: 380px) {
  .nav a { padding: 4px 8px; }
}

/* Header/Footer */
.site-header { padding: var(--space-4); border-bottom: 1px solid var(--color-border); background: var(--color-bg); }
.site-footer { padding: var(--space-6) var(--space-4); font-size: var(--font-size-sm); background: var(--color-bg-alt); margin-top: var(--space-8); }

/* When content is short, remove artificial top margin so footer sits on same viewport without scroll */
body.no-scroll-footer .site-footer { margin-top: auto; }
/* Guard: ensure main grows to push footer when enough content exists */
body .main { flex: 1 0 auto; }

.skip-link { position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip-link:focus { left:8px; top:8px; width:auto; height:auto; background:var(--color-bg); padding:var(--space-2) var(--space-3); border:2px solid var(--color-primary); z-index:1000; }

.main { padding: var(--space-6) 0; flex: 1 0 auto; }

.site-footer { flex-shrink: 0; }

/* Theme toggle icon button */
.theme-icon-btn {
  background: var(--color-bg-alt);
  border: 1px solid var(--color-border);
  padding: 6px;
  border-radius: 50%;
  cursor: pointer;
  color: var(--color-fg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: background var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast), transform var(--transition-fast);
}
.theme-icon-btn:hover, .theme-icon-btn:focus-visible {
  background: var(--color-primary-light);
  border-color: var(--color-primary);
  outline: none;
}
.theme-icon-btn:active { transform: scale(.92); }

[data-theme='dark'] .theme-icon-btn {
  background: #1b2534;
  border-color: #46566e;
  color: #f1f5f9;
}
[data-theme='dark'] .theme-icon-btn:hover, [data-theme='dark'] .theme-icon-btn:focus-visible {
  background: #233044;
  border-color: var(--color-primary);
}

/* Smooth theme cross-fade (opt-in via JS adds .theme-animating briefly). */
@media (prefers-reduced-motion: no-preference) {
  .theme-animating, .theme-animating * {
    transition: background-color 250ms ease, color 250ms ease, border-color 250ms ease, fill 250ms ease, stroke 250ms ease;
  }
  /* Avoid animating large images/videos for performance */
  .theme-animating img, .theme-animating video { transition: none !important; }
}

/* Prevent transition flash on first paint */
html:not(.js) .theme-animating { transition: none !important; }

/* Trim excessive bottom spacing inside last container when footer is auto-attached */
body.no-scroll-footer .main .container > *:last-child { margin-bottom: var(--space-4); }

/* Homepage Enhancements */
.lead { font-size: 1.125rem; line-height: var(--line-height-relaxed); color: var(--color-fg-mid); max-width: 65ch; }
.hero { margin-top: var(--space-4); margin-bottom: var(--space-8); }
.hero-grid { display:grid; gap: var(--space-7); align-items:center; grid-template-columns: 1fr 340px; }
@media (max-width: 880px) { .hero-grid { grid-template-columns: 1fr; } .hero-media { order:-1; justify-self:center; } }
.hero-actions { display:flex; gap: var(--space-3); flex-wrap:wrap; margin-top: var(--space-4); }
.hero h1 { margin-top:0; }
.micro { font-size: var(--font-size-xs); letter-spacing: .5px; text-transform: uppercase; margin-top: var(--space-4); }
.media-placeholder { width: 100%; aspect-ratio: 4 / 5; border-radius: var(--radius-lg); background: linear-gradient(135deg, var(--color-primary-light), #fff); border: 1px solid var(--color-border); box-shadow: var(--shadow-md); opacity:.6; }

/* Buttons (base already partly covered) */
.btn, .btn-outline, .btn-ghost { font: inherit; line-height:1.2; text-decoration:none; }
.btn { background: var(--color-primary); color:#fff; padding: .75rem 1.1rem; border-radius: var(--radius-md); font-weight:500; display:inline-flex; align-items:center; gap:.5rem; box-shadow: var(--shadow-sm); transition: background var(--transition-base), transform var(--transition-base), box-shadow var(--transition-base); }
.btn:hover { background: #115e58; text-decoration:none; transform: translateY(-2px); }
.btn:active { transform: translateY(0); }
.btn-outline { padding:.72rem 1.05rem; border:1px solid var(--color-border); border-radius: var(--radius-md); color: var(--color-fg); background: var(--color-bg); transition: background var(--transition-fast), border-color var(--transition-fast); }
.btn-outline:hover { background: var(--color-bg-alt); text-decoration:none; }
.btn-ghost { padding:.55rem .9rem; border-radius: var(--radius-md); color: var(--color-primary); background: transparent; }
.btn-ghost:hover { background: var(--color-primary-light); text-decoration:none; }

/* Process Steps */
.process-steps { margin-top: var(--space-9); }
.steps { list-style:none; margin:0; padding:0; display:grid; gap: var(--space-6); grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); counter-reset: step; }
.steps li { position:relative; padding: var(--space-4) var(--space-4) var(--space-4) var(--space-4); background: var(--color-bg-alt); border:1px solid var(--color-border); border-radius: var(--radius-lg); }
.steps h3 { font-size: var(--font-size-lg); margin:0 0 var(--space-2); line-height: var(--line-height-snug); }
.steps p { margin:0; font-size: var(--font-size-sm); line-height: var(--line-height-normal); }
[data-theme='dark'] .steps li { background: var(--color-surface); border-color: #2a3a50; }

/* FAQ */
.faq { margin-top: var(--space-9); }
.faq-items { display:flex; flex-direction:column; gap: var(--space-3); }
.faq-items details { background: var(--color-bg-alt); border:1px solid var(--color-border); border-radius: var(--radius-md); padding: var(--space-3) var(--space-4); }
.faq-items summary { cursor:pointer; font-weight:500; outline:none; list-style:none; }
.faq-items summary::-webkit-details-marker { display:none; }
.faq-items details[open] { background: var(--color-bg); }
.faq-items details[open] summary { margin-bottom: var(--space-2); }
.faq-items p { margin:0; font-size: var(--font-size-sm); }
[data-theme='dark'] .faq-items details { background: var(--color-surface); border-color:#2a3a50; }
[data-theme='dark'] .faq-items details[open] { background:#182230; }

/* CTA final */
.cta-final { margin-top: var(--space-9); }
.cta-box { text-align:center; }
.cta-box p { margin: 0 0 var(--space-3); }

/* List plain utility */
.list-plain { list-style:none; padding:0; margin:0 0 var(--space-5); }
.list-plain li { margin:0 0 var(--space-2); }

/* Animation utility */
@media (prefers-reduced-motion: no-preference) {
  .fade-in { opacity:0; transform: translateY(8px); animation: fadeUp .55s ease forwards; }
  @keyframes fadeUp { to { opacity:1; transform: translateY(0); } }
}
